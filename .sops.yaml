keys:
  # TODO: figure out what the command was
  - &yubikey_alpha 7A5FB73E81C9215C692D994349E1D3136F71FED7
    # nix-shell -p ssh-to-age --run 'ssh-keyscan reaper | ssh-to-age'
  - &reaper_host age1d3hhj0tzjrqt7w5nzqx86fha5cemmgdn99n5v2aw76ut7ucp8vyqspxyhn
    # nix-shell -p ssh-to-age --run 'ssh-keyscan hoard | ssh-to-age'
  - &hoard_host age1ae5trkyduadhc45d90svq9yem62fhj676m4jyapplcsrjq78tf2qtk2yuw
    # nix-shell -p ssh-to-age --run 'ssh-keyscan harbor | ssh-to-age'
  - &harbor_host age142kp0x4azfwvmxe0drmpt0lug4upj22wahefsezrcv3nvmcgkeds74jeld
    # key generated with a nix-darwin launchd daemon
    # cat /var/log/sops-keygen.log
  - &eve_host age17h86yfzhhn47lnp64r4szyu2dwd6gwt7nxwy3hlcuuq06ycd3slsh580m4
    # generated by terraform and stored in secrets manager
  - &buoy_host age1n2s86y3uf6q7ss5mpktzj4utuyff4v7h0zh8ygk9q9v4p5qvxf0s30vtg0
creation_rules:
  - path_regex: secrets/common/.*
    key_groups:
      - age:
          - *reaper_host
          - *hoard_host
          - *harbor_host
          - *eve_host
          - *buoy_host
        pgp:
          - *yubikey_alpha
  - path_regex: secrets/reaper/.*
    key_groups:
      - age:
          - *reaper_host

  - path_regex: secrets/hoard/.*
    key_groups:
      - age:
          - *hoard_host
        pgp:
          - *yubikey_alpha
  - path_regex: secrets/harbor/.*
    key_groups:
      - age:
          - *harbor_host
        pgp:
          - *yubikey_alpha
  - path_regex: secrets/eve/.*
    key_groups:
      - age:
          - *eve_host
        pgp:
          - *yubikey_alpha
  - path_regex: secrets/buoy/.*
    key_groups:
      - age:
          - *buoy_host
        pgp:
          - *yubikey_alpha
  - path_regex: secrets/infra/.*
    key_groups:
      - age:
          - *eve_host
          - *reaper_host
          - *hoard_host
        pgp:
          - *yubikey_alpha
